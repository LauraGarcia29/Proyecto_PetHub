<div class="container mt-4">
  <h2 class="text-center">Bienvenido al Dashboard</h2>

  <div *ngIf="userData">
    <p class="text-center">Hola, <strong>{{ userData.NAME }}</strong>!</p>
    <p class="text-center">Tu correo: <strong>{{ userData.EMAIL }}</strong></p>
  </div>

  <!-- 📌 Botón registrar mascota -->
  <button class="btn btn-success" (click)="toggleFormulario()">
  {{ mostrarFormulario ? 'Ocultar Formulario' : 'Registrar Mascota' }}
</button>

  <div *ngIf="mostrarFormulario" class="mt-4">
  <h2>Registrar Mascota</h2>
   
  <div *ngIf="mensajeExito" class="alert alert-success text-center">
  {{ mensajeExito }}
</div>

<div *ngIf="mensajeError" class="alert alert-danger text-center">
  {{ mensajeError }}
</div>

  <form (ngSubmit)="agregarMascota()">
    <div class="mb-3">
      <label class="form-label">Nombre</label>
      <input type="text" class="form-control" [(ngModel)]="petData.NAME" name="NAME" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Especie</label>
      <select class="form-control" [(ngModel)]="petData.SPECIE" name="SPECIE" required>
        <option value="perro">Perro</option>
        <option value="gato">Gato</option>
        <option value="ave">Ave</option>
        <option value="otro">Otro</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Edad</label>
      <input type="number" class="form-control" [(ngModel)]="petData.AGE" name="AGE" required>
    </div>

    
    <button type="submit" class="btn btn-primary">Registrar</button>
  </form>
</div>

<button class="btn btn-info" (click)="toggleFormularioCita()">
  {{ mostrarFormularioCita ? 'Ocultar Formulario de Cita' : 'Agendar Cita' }}
</button>

<div *ngIf="mensajeExitoCita" class="alert alert-success text-center">
  {{ mensajeExitoCita }}
</div>

<div *ngIf="mensajeErrorCita" class="alert alert-danger text-center">
  {{ mensajeErrorCita }}
</div>

<!-- 📌 Botón Agregar cita -->
<div *ngIf="mostrarFormularioCita" class="mt-4">
  <h2>Agendar Cita</h2>
  <p>Recuerda que los horarios de atención son de Lunes a Viernes de 8:00 a.m a 5:00 p.m - Sabados de 9:00 a.m. a 1:00 p.m.</p>
  <form (ngSubmit)="agendarCita()">
    <div class="mb-3">
      <label class="form-label">Fecha y Hora</label>
      <input type="datetime-local" class="form-control" [(ngModel)]="appointmentData.DATE" name="DATE" required>
    </div>

    <div class="mb-3">
      <label class="form-label">Tipo de Cita</label>
      <select class="form-control" [(ngModel)]="appointmentData.TYPE" name="TYPE" required>
        <option value="vacunación">Vacunación</option>
        <option value="consulta">Consulta</option>
        <option value="baño">Baño</option>
        <option value="otro">Otro</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Mascota</label>
      <select class="form-control" [(ngModel)]="appointmentData.PET_ID" name="PET_ID" required>
        <option *ngFor="let mascota of mascotas" [value]="mascota.ID">{{ mascota.NAME }}</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">Especialista</label>
      <select class="form-control" [(ngModel)]="appointmentData.SPECIALIST_ID" name="SPECIALIST_ID" required>
        <option *ngFor="let especialista of especialistas" [value]="especialista.ID">{{ especialista.NAME }}</option>
      </select>
    </div>

    <button type="submit" class="btn btn-primary">Registrar Cita</button>
  </form>

<!-- 📌 Botón consultar tus mascota -->
</div>
<button class="btn btn-info" (click)="obtenerMisMascotas()">
  Consultar Tus Mascotas
</button>

<div *ngIf="mensajeErrorMascotas" class="alert alert-danger text-center">
  {{ mensajeErrorMascotas }}
</div>

<div *ngIf="mascotas.length">
  <h2>Tus Mascotas</h2>
  <ul class="list-group">
    <li *ngFor="let mascota of mascotas" class="list-group-item">
      <strong>Nombre:</strong> {{ mascota.NAME }}  
      <br>
      <strong>Tipo:</strong> {{ mascota.TYPE }}
    </li>
  </ul>
</div>

<!-- 📌 Botón consultar citas -->
<button class="btn btn-primary" (click)="obtenerCitas()">
  Consultar Citas
</button>

<div *ngIf="mensajeErrorCitas" class="alert alert-danger text-center">
  {{ mensajeErrorCitas }}
</div>

<div *ngIf="citas.length">
  <h2>Tus Citas</h2>
  <ul class="list-group">
    <li *ngFor="let cita of citas" class="list-group-item">
      <strong>Fecha:</strong> {{ cita.DATE }}  
      <br>
      <strong>Tipo:</strong> {{ cita.TYPE }}  
      <br>
      <strong>Especialista:</strong> {{ cita.SPECIALIST_ID }}
    </li>
  </ul>
</div>



<!-- 📌 Botón para consultar todas las mascotas -->
<button class="btn btn-success" (click)="obtenerTodasMascotas()">
  Consultar Mascotas
</button>

<div *ngIf="mensajeErrorTodasMascotas" class="alert alert-danger text-center">
  {{ mensajeErrorTodasMascotas }}
</div>

<div *ngIf="todasMascotas.length">
  <h2>Listado de Mascotas</h2>
  <ul class="list-group">
    <li *ngFor="let mascota of todasMascotas" class="list-group-item">
      <strong>Nombre:</strong> {{ mascota.NAME }}  
      <br>
      <strong>Tipo:</strong> {{ mascota.TYPE }}
    </li>
  </ul>
</div>

<!-- 📌 Botón para consultar citas del usuario -->
<button class="btn btn-primary mt-3" (click)="obtenerMisCitas()">
  Consultar Mis Citas
</button>

<div *ngIf="mensajeErrorMisCitas" class="alert alert-danger text-center">
  {{ mensajeErrorMisCitas }}
</div>

<div *ngIf="misCitas.length">
  <h2>Mis Citas</h2>
  <ul class="list-group">
    <li *ngFor="let cita of misCitas" class="list-group-item">
      <strong>Fecha:</strong> {{ cita.DATE }}  
      <br>
      <strong>Tipo:</strong> {{ cita.TYPE }}  
      <br>
      <strong>Especialista:</strong> {{ cita.SPECIALIST_ID }}
    </li>
  </ul>
</div>


<!-- 📌 Botón para consultar citas por especialista -->
<button class="btn btn-warning" (click)="obtenerCitasPorEspecialista()">
  Consultar Citas por Especialista
</button>

<div *ngIf="mensajeErrorCitasEspecialista" class="alert alert-danger text-center">
  {{ mensajeErrorCitasEspecialista }}
</div>

<div *ngIf="citasEspecialista.length">
  <h2>Citas por Especialista</h2>
  <ul class="list-group">
    <li *ngFor="let cita of citasEspecialista" class="list-group-item">
      <strong>Fecha:</strong> {{ cita.DATE }}  
      <br>
      <strong>Tipo:</strong> {{ cita.TYPE }}  
      <br>
      <strong>Usuario:</strong> {{ cita.USER_ID }}
    </li>
  </ul>
</div>

<!-- 📌 Botón para consultar usuarios -->
<button class="btn btn-dark mt-3" (click)="obtenerUsuarios()">
  Consultar Usuarios
</button>

<div *ngIf="mensajeErrorUsuarios" class="alert alert-danger text-center">
  {{ mensajeErrorUsuarios }}
</div>

<div *ngIf="usuarios.length">
  <h2>Usuarios Registrados</h2>
  <ul class="list-group">
    <li *ngFor="let usuario of usuarios" class="list-group-item">
      <strong>Nombre:</strong> {{ usuario.NAME }}  
      <br>
      <strong>Email:</strong> {{ usuario.EMAIL }}  
      <br>
      <strong>Rol:</strong> {{ usuario.ROL }}
    </li>
  </ul>
</div>

<!-- 📌 Botón para actualizar mascota por ID -->
<button class="btn btn-warning" (click)="actualizarMascota()">
  Actualizar Mascota
</button>

<!-- 📌 Botón para actualizar cita por ID -->
<button class="btn btn-primary" (click)="actualizarCita()">
  Actualizar Cita
</button>

<!-- 📌 Botón para eliminar mascota por ID -->
<button class="btn btn-danger" (click)="eliminarMascota()">
  Eliminar Mascota
</button>

<!-- 📌 Botón para eliminar cita por ID -->
<button class="btn btn-danger" (click)="eliminarCita()">
  Eliminar Cita
</button>

<!-- 📌 Botón para consultar perfil en sesión -->
<button class="btn btn-info" (click)="consultarPerfilSesion()">
  Consultar Perfil en Sesión
</button>

  <button class="btn btn-danger" (click)="logout()">Cerrar sesión</button>
</div>

<!-- 📌 Botones para el ADMIN -->
<div *ngIf="rolUsuario === 'Admin'">
  <button class="btn btn-success" (click)="agregarMascota()">Registrar Mascota</button>
  <button class="btn btn-primary" (click)="agendarCita()">Agregar Cita</button>
  <button class="btn btn-info" (click)="obtenerMisCitas()">Consultar Citas</button>
  <button class="btn btn-warning" (click)="obtenerTodasMascotas()">Consultar Mascotas</button>
  <button class="btn btn-dark" (click)="obtenerUsuarios()">Consultar Usuarios</button>
  <button class="btn btn-warning" (click)="actualizarMascota()">Actualizar Mascotas</button>
  <button class="btn btn-primary" (click)="actualizarCita()">Actualizar Citas</button>
  <button class="btn btn-danger" (click)="eliminarMascota()">Eliminar Mascotas</button>
  <button class="btn btn-danger" (click)="eliminarCita()">Eliminar Citas</button>
 <button class="btn btn-info" (click)="obtenerPerfilSesion()">Consultar Perfil en Sesión</button>
</div>

<!-- 📌 Botones para el USER -->
<div *ngIf="rolUsuario === 'User'">
  <button class="btn btn-success" (click)="agregarMascota()">Registrar Mascota</button>
  <button class="btn btn-primary" (click)="agendarCita()">Agendar Cita</button>
  <button class="btn btn-info" (click)="obtenerMisMascotas()">Consultar Mis Mascotas</button>
  <button class="btn btn-warning" (click)="obtenerMisCitas()">Consultar Mis Citas</button>
</div>

<!-- 📌 Botones para el SPECIALIST -->
<div *ngIf="rolUsuario === 'Specialist'">
  <button class="btn btn-info" (click)="obtenerCitasPorEspecialista()">Consultar Citas por Especialista</button>
  <button class="btn btn-warning" (click)="actualizarMascota()">Actualizar Mascotas</button>
</div>